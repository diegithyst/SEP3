@page "/AdminMainPage"
@using System.Security.Claims
@using Domain.Model
@using HttpClients.ClientInterfaces
@inject IClientService ClientSquared
@inject NavigationManager nvgMg

<div class="post-list">
    <div class="post-card">
        @foreach (var client in Clients)
        {
            <div class="post">
                <h2 class="post-title">
                    <a href="/ClientAdminPage/@client.id">@client.firstname @client.lastname</a>
                </h2>
                <p class="post-date">ID: @client.id</p>
            </div>
        }
    </div>
</div>

@code {

    [CascadingParameter]
    public Task<AuthenticationState> AuthState { get; set; } = null!;

    private Administrator admin;
    private IEnumerable<Client> Clients;

    protected override async Task OnInitializedAsync()
    {
        AuthenticationState authState = await AuthState;
        ClaimsPrincipal admin_ = authState.User;
    //TODO check that the logged user is an admin

        Clients = await ClientSquared.GetAsync();
    }
}